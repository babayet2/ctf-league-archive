# snowcone

## Description

```
Another day, another intrusion here at IcyRetina. Can you help recover the encrypted files APT42 stole from this victim?

(real malware is real, don't run the binary)

Wireshark and dnSpy might be helpful (if you are on Linux, use Wine for dnSpy)
```

@babayet2 give players the PCAP in `dist/`

## Flag

```
osu{1f_it_d03snT_5now_1m_GoNn4_sue_sOm3b0dy}
```

## Info

PCAP has communications between two servers, attacker and victim:

* Attacker pops a shell on the victim (nc powershell or something)
* Attacker HTTP downloads the binary
* Attacker runs the binary
* Attacker exfils the encrypted files

From PCAP, player can get:

* Binary
* Encrypted output (in which the flag will be)

Players use dnSpy or something to rev the malware to identify how the crypto works, and how to recover the key (maybe generated by the binary and combined in the encrypted file output or something)

Binary has a guardrail to prevent accidental encryption (hostname check)

## Solution

Open the PCAP in Wireshark. Export HTTP objects to get the malware binary, and follow TCP stream on 1337/tcp to get the exfil'd b64 payload (save to disk, 338kb or something). Use dnSpy to reverse the malware, easy key extraction from the encrypted files (see `soln/decrypt.py`). Decrypt the flag file to get the flag.
